# RehearsalLink 開発ガイドライン (GEMINI.md)

このプロジェクトでは、以下のルールに従って開発を進めます。

## 1. 開発フロー
1.  **タスクの特定と細分化**: `docs/tasks/progress.md` から着手すべきタスクを確認します。タスクが巨大な場合は、さらに小さな単位に分割してください。
2.  **原子的な作業（絶対遵守）**:
    - **一度に複数のタスク（あるいはフェーズ全体）をまとめて実装することは厳禁です。**
    - 1つのPR、1つのコミット、1つの会話ターンで扱うのは「ただ1つの最小タスク」のみとしてください。
    - このルールを破った場合、修正内容が正しくても差し戻しの対象となります。
3.  **ユーザーへの確認（必須）**: 特定した**1つのタスク**の内容をユーザーに提示し、**必ず実行の許可（「やってください」「お願いします」等）を得てください。**
    - タスクの内容に不明点や曖昧な点がある場合は、**修正計画を立てる前に必ずユーザーに質問して明確にしてください。**
    - 修正計画（どのファイルをどう変えるか）を立てた後も、その計画をユーザーに提示し、合意を得てから着手してください。
    - 許可を得るまでは、いかなる実装（コードの変更や新規作成）も開始してはなりません。
4.  **実装**: ユーザーから許可を得た**ただ1つのタスク**のみを実装し、必要に応じてテストコードを記述します。
5.  **検証**:
    - 実装後は必ず `test` および `build` を実行し、リグレッションやビルドエラーがないことを確認してください。
6.  **進捗更新と完了報告**: タスクが完了し検証が通ったら、直ちに `docs/tasks/progress.md` 等の進捗を更新し、ユーザーに完了を報告してください。
7.  **レビュー**:
    - ユーザー（マネージャー）のレビューを受け、承認を得てから次の**1つのタスク**へ進みます。
    - 1つのフェーズ内の全タスクが完了した際も同様に報告し、次のフェーズへ進む承認を得てください。
    - リリースが必要な場合は、[6. リリース手順](#6-リリース手順) に従ってリリースを行ってください。

## 2. システム要件とAPIリファレンス
本プロジェクトのコア機能が依存するテクノロジーと最新のOS環境は以下の通りです。

### 最新OS環境 (2026年2月時点)
- **macOS 26 (Tahoe)**: 最新安定版 26.2 (RC 26.3)
- **iOS 26**: 最新安定版 26.2.1 (RC 26.3)

### コア機能のAPI要件
- **Speech Transcription & Analysis (Speech.framework)**
    - **SFSpeechAnalyzer (SpeechAnalyzer)**: **iOS 26.0+ / macOS 26.0+**
        - 最新の高度な音声解析（セグメンテーション、高精度文字起こし）に使用。
- **Audio Engine & Editing (AVFoundation.framework)**
    - 再生、解析、波形生成、セグメント結合、エクスポートに使用。
    - AVComposition / AVAssetExportSession: iOS 4.0+ / macOS 10.7+
    - AVAudioEngine (モダンなオーディオ制御): iOS 8.0+ / macOS 10.10+

### Apple 開発者向け資料
- [Apple Developer Documentation](https://developer.apple.com/documentation/)
- [Speech Framework Reference](https://developer.apple.com/documentation/speech)
- [AVFoundation Framework Reference](https://developer.apple.com/documentation/avfoundation)
- [Human Interface Guidelines (macOS)](https://developer.apple.com/design/human-interface-guidelines/macos)

## 3. コミット・変更ルール
- コードの変更は、既存のスタイルとアーキテクチャ（MVVM）を尊重してください。
- ファイルの追加・変更後は、必ずその内容が正しく動作するか（ビルドエラーがないか等）を確認してください。

## 4. ドキュメント管理
- `docs/tasks/` 以下の進捗管理ファイルは、プロジェクトの「真実のソース」として常に最新の状態を保ってください。

## 5. コミュニケーション
- ユーザーとの対話は日本語で行ってください。

## 6. リリース手順
フェーズの完了時など、新しいバージョンをリリースする場合は以下の手順で行います。
1.  **タグの作成**: セマンティックバージョニングに基づき、新しいバージョンタグを作成します（例: `v1.0.8`）。
    - `git tag v1.0.x`
2.  **タグのプッシュ**: 作成したタグをリモートにプッシュします。
    - `git push origin v1.0.x`
3.  **自動ビルドの確認**: GitHub Actions の `release.yml` ワークフローが起動し、自動的に `.app` バンドルのビルドと配布用 ZIP の作成、GitHub Release へのアップロードが行われるのを待ちます。

---

## 開発状況
最新の進捗は [docs/tasks/progress.md](./docs/tasks/progress.md) を参照してください。
