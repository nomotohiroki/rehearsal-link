# Phase 6: 機能拡張と出力強化

このフェーズでは、ユーザビリティの向上（ズーム、詳細編集）と、解析結果を活用した高度な再生・出力機能（ループ再生、特定種別の書き出し）を実装します。

## 1. 波形ズーム機能 (Horizontal Zoom)
波形表示を水平方向に拡大・縮小可能にし、細かい編集を容易にします。

- [x] **ViewModelへのズーム状態追加**
  - `zoomLevel` (Double, default 1.0) プロパティを追加。
  - ズームイン/アウトのアクション（`zoomIn()`, `zoomOut()`）を実装。
- [x] **WaveformViewの改修**
  - 現在の描画ロジックに `zoomLevel` を適用。
  - `ScrollView` (.horizontal) で波形全体をラップし、ズーム時にスクロール可能にする。
  - 再生ヘッド位置への自動スクロール追従（オプション）。
- [x] **UIコントロールの配置**
  - ツールバーまたは波形周辺にズームスライダーまたは +/- ボタンを配置。

## 2. Inspector拡充とラベル編集
セグメントに任意の名称（ラベル）を付けられるようにし、管理しやすくします。

- [x] **AudioSegmentモデルの更新**
  - `label: String?` プロパティを追加（既存のJSON互換性に配慮）。
- [x] **Inspectorパネルの更新**
  - 「Label」テキストフィールドを追加。
  - 編集時にViewModelを通じてモデルを更新する処理の実装。

## 3. セグメントのループ再生
特定の区間を重点的に確認するための機能です。

- [x] **再生ロジックの拡張**
  - `isLooping` (Bool) フラグを追加。
  - `AudioPlayerService` にループ区間設定の機能を追加、または再生位置監視タイマー内で「終了位置到達時に開始位置へシーク」する処理を追加。
- [x] **UIへの反映**
  - トランスポートバーに「ループ再生」トグルボタンを追加。
  - 選択中のセグメントがある場合のみ有効化。

## 4. セグメント結合書き出し (Export)
解析・編集された「演奏」や「会話」のみを集めて、ダイジェスト音源を作成します。

- [x] **ExportServiceの作成**
  - `AVAsset` / `AVComposition` を使用して、指定された時間範囲（セグメント群）を結合するロジックを実装。
  - 指定されたフォーマット（m4a/aac推奨）でのエクスポート処理。
- [x] **ViewModelへのエクスポート機能追加**
  - `exportSegments(type: SegmentType)` メソッドの実装。
  - 書き出し中の進捗表示（Loading状態の管理）。
- [x] **メニュー/UIへの追加**
  - ファイルメニューまたはツールバーに「Export Music Only」「Export Speech Only」を追加。
