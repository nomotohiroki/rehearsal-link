# RehearsalLink

RehearsalLinkは、音楽合奏の録音ファイルを解析し、指導者の指示（会話）と演奏箇所を自動的に識別・マーキングすることで、効率的な練習の振り返りを支援するmacOSアプリケーションです。

## 1. アプリケーションの目的

音楽の合奏練習において、録音を聞き返す作業は重要ですが、長時間の録音から「特定の指示があった箇所」や「特定の演奏箇所」を探し出すのは手間がかかります。
RehearsalLinkは、音声解析技術を用いて録音内の**演奏**と**会話（指示）**を自動で判別し、視覚的なインデックスを提供することで、必要な箇所へ即座にアクセスすることを可能にします。

## 2. 主な機能

### 2.1 音声解析・可視化
- **音声波形の描画**: 音声ファイルを読み込み、高精度な波形を表示します。
- **自動セグメンテーション**: 音量（RMS）および周波数特性に基づき、演奏区間と会話区間を自動で判別します。
- **カラーマーキング**: 波形上で演奏区間（例：青）と指示区間（例：緑）を色分けして表示します。

### 2.2 再生・編集
- **直感的な再生制御**: 標準的な再生/一時停止に加え、波形上のクリックによるダイレクトなシークが可能です。
- **手動微調整**: 自動判定された区間の境界をドラッグで調整したり、種別を切り替えたりすることができます。
- **区間管理**: 重要な箇所に個別にラベルを付けることができます。

### 2.3 データ管理
- **対応フォーマット**: WAV, MP3, AAC などの主要な音声形式に対応。
- **プロジェクト保存**: 解析結果やユーザーの編集内容をJSON形式で保存し、後から再開することが可能です。

## 3. 技術スタック

### 開発環境・言語
- **OS**: macOS 15.0+
- **Language**: Swift 6.0
- **UI Framework**: SwiftUI (macOSネイティブ)

### フレームワーク
- **AVFoundation**: 音声ファイルのデコード、PCMデータの取得、およびオーディオ再生制御。
- **Accelerate (vDSP)**: 高速な音声信号処理（RMS計算、FFT解析）による自動判定ロジックの実現。
- **Foundation (Codable)**: 解析データおよびメタデータのJSONシリアライズ。

## 4. アーキテクチャ

本プロジェクトは **MVVM (Model-View-ViewModel)** パターンを採用しています。

- **Model**: `AudioBuffer`, `RegionMarker`, `SessionData`
- **View**: `MainView`, `WaveformView`, `ControlBar`
- **ViewModel**: `AudioViewModel`, `WaveformViewModel`
- **Service**: `AudioLoadService`, `AudioPlayerService`, `AnalyzerService`

## 5. 開発ロードマップ

詳細は `docs/tasks/` フォルダ内の各フェーズドキュメントを参照してください。

1. **Phase 1**: プロジェクト基盤とファイル読み込み（完了条件：音声ファイルのロード）
2. **Phase 2**: 波形表示と再生の基本（完了条件：波形表示と音出し）
3. **Phase 3**: 自動判定ロジックの実装（完了条件：演奏と会話の自動分類）
4. **Phase 4**: UIインタラクションと編集（完了条件：マウスによる区間編集）
5. **Phase 5**: データ保存と仕上げ（完了条件：JSON保存とUIブラッシュアップ）

---

## 開発ガイドライン

開発の進め方については [GEMINI.md](./GEMINI.md) を参照してください。
